<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="icon" href="../assets/images/logo/favicon.ico" type="image/x-icon"/>
  <link rel="stylesheet" href="../assets/greenpanier.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <title>GreenPanier</title>
  <style>

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: monospace;
      display: flex;
      flex-direction: column;
      width: 100%;
      min-height: 100vh;
    }

    .container::-webkit-scrollbar {
      display: none;
    }

    header {
      position: relative;
      width: 100%;
      background-image: linear-gradient(rgba(255, 255, 255, 0.75), rgba(255, 255, 255, 0.75)), url('../assets/images/bg/header.png');
      background-repeat: repeat;
      background-size: 173px;
      padding: 25px;
    }

    h1 {
      font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
      color: lightgreen;
      font-weight: bolder;
      text-align: center;
      text-shadow: 0.75px 0 black, -0.75px 0 black, 0 0.75px black, 0 -0.75px black;
      margin: 0.25em;
      font-size: 75px;
    }
    
    .header-icons {
      position: absolute;
      top: 25px;
      right: 25px;
      display: flex;
      gap: 25px;
      align-items: center;
    }

    .header-icons a i {
      font-size: 35px;
      color: green;
    }

    .header-icons a i:hover {
      transform: scale(1.25);
      color: lightgreen;
    }
    
    main {
      background: rgba(144, 238, 144, 0.123);
      width: 100%;
      margin: auto;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .products-container {
      display: grid;
      text-align: center;
      grid-template-columns: repeat(4, 1fr);
      gap: 25px;
      width: 100%;
      margin: 7px;
      padding: 25px;
    }

    .product-box {
      background: white;
      border: 1px solid rgba(112, 205, 50, 0.5);
      border-radius: 1em;
      padding: 7px;
    }

    .product-box img {
      width: 100%;
      height: 200px;
      object-fit: contain;
      border-radius: 1.25em;
      margin-bottom: 15px;
    }

    .product-box hr {
      margin: 25px;
      border: none;
      height: 1px;
      background-color: lightgreen;
    }

    .product-box h3 {
      margin: 15px;
      color: black;
    }

    .product-box p {
      color: black;
      margin-bottom: 15px;
    }

    .product-box button {
      background-color: lightgreen;
      color: black;
      font-weight: bold;
      padding: 10px;
      width: 100%;
      border: none;
      border-radius: 0.75em;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.25s, transform 0.2s;
    }

    .product-box button:hover {
      background-color: green;
      color: white;
      transform: scale(1.02);
    }
        
    footer {
      font-family: Verdana, Geneva, Tahoma, sans-serif;
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 15px;
      box-sizing: border-box;
      background-color: lightgreen;
      margin-top: auto;
    }
    
    footer .footer-section {
      font-size: 15px;
      flex: 1;
    }
    
    footer .footer-section.left {
      text-align: left;
    }
    
    footer .footer-section.center {
      text-align: center;
    }
    
    footer .footer-section.right {
      text-align: right;
    }
    
    footer .footer-section.left a {
      color: black;
      margin-left: 15px;
      font-size: 45px;
      transition: color 0.25s;
      text-decoration: none;
    }
    
    footer .footer-section.left a:hover {
      color: #2e7d32;
    }
    
    footer .footer-logo {
      transition: transform 0.25s ease;
      width: 3vw;
      height: 3vw;
      min-width: 33px;
      min-height: 33px; 
      border-radius: 75%;
      object-fit: cover;
    }

    footer .footer-logo:hover {
      transform: translateY(-5px) scale(1.025);
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.25);
    }
    
    #toast-container {
      position: fixed;
      bottom: 25px;
      right: 25px;
      z-index: 9999;
    }
    
    .toast {
      font-size: 15px;
      background-color: lightgreen;
      color: black;
      padding: 15px 25px;
      margin-top: 15px;
      border-radius: 5px;
      box-shadow: 0 3px 4px rgba(0,0,0,0.25);
      opacity: 0;
      transform: translateX(100%);
      animation: slideIn 0.25s forwards, fadeOut 0.25s ease-in-out 2.5s forwards;
    }
    
    @keyframes slideIn {
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    @keyframes fadeOut {
      to {
        opacity: 0;
        transform: translateX(100%);
      }
    }

    @media (max-width: 992px) {
      .products-container {
         grid-template-columns: repeat(3, 1fr);
      }
      h1 {
         font-size: 65px;
      }  
      .header-icons a i {
         font-size: 35px;
      }
    }

    @media (max-width: 768px) {
      .products-container {
         grid-template-columns: repeat(2, 1fr);
      }   
      h1 {
         font-size: 55px;
      }   
      .header-icons {
         gap: 15px;
      }   
      .product-box img {
         height: 150px;
      }
    }

    @media (max-width: 576px) {
      .products-container {
        grid-template-columns: 1fr;
        padding: 15px;
      }
      
      h1 {
        font-size: 75px;
      }
      
      header {
        padding: 15px;
        display: flex;
        flex-direction: column;
        text-align: flex-end;
      }
      
      .header-icons {
        position: relative;
        top: auto;
        left: auto;
        justify-content: flex-end;
        margin-top: 15px;
      }
      
      .product-box {
        max-width: 750px;
        margin: 0 auto;
      }
      
      footer {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }
      
      footer .footer-section {
        text-align: center;
      }
      
      footer .footer-section.right {
        order: 1;
      }
      
      footer .footer-section.center {
        order: 2;
      }
      
      footer .footer-section.left {
        order: 3;
      }
    }

    @media (max-width: 400px) {
      .products-container {
        padding: 10px;
        gap: 10px;
      }
  
      h1 {
        font-size: 50px;
      }
      
      .header-icons a i {
        font-size: 28px;
      }
      
      .product-box {
        padding: 15px;
      }
      
      .product-box img {
        height: 120px;
      }
      
      header {
        padding: 10px;
      }
      
      .header-icons {
        gap: 10px;
        margin-top: 10px;
      }
      
      footer {
        padding: 15px 10px;
      }
    }

  </style>
</head>
<body class="container">
  <header id="the_header">
    <div id="time-toast-container"></div>
    <div class="header-icons">
      <a href="../pages/cart_payment.html"><i class="fas fa-shopping-cart"></i></a>
      <a href="../pages/login.html"><i class="fas fa-user"></i></a>
    </div>
    <h1>GreenPanier</h1>
  </header>
    <main>
      <div class="products-container" id="products">
        <!--mama JS will dynamically fetch the products...-->
      </div>
    </main>

    <footer class="footer-container">
      <div class="footer-section left">
        <a href="https://github.com/chaxyouxbraoui7/green-panier" target="_blank">
          <i class="fab fa-github"></i>
        </a>
        <b>Our Website Code Source</b>
      </div>
      <div class="footer-section center">
        <p>&copy; 2025 GreenPanier | All rights reserved</p>
      </div>
      <div class="footer-section right">
        <img src="../assets/images/logo/logo.png" alt="Logo" class="footer-logo">
      </div>
    </footer>
    <div id="toast-container"></div>
    <script src="../assets/greenpanier.js"></script>
    <script>
        function fetchProducts() {fetch('../server/fetch_products.php').then(response => {
              if (!response.ok) throw new Error("Erreur serveur");
              return response.json();
            }).then(data => {
          const container = document.getElementById('products');
          container.innerHTML = '';
        
          if (data.status !== 'success' || data.products.length === 0) {
            container.innerHTML = '<p><strong>No product for now...</strong></p>';
            return;
          }
        
          function addToCart(product) {
            const cart = JSON.parse(localStorage.getItem("cart")) || [];
            const exi_in_cart = cart.find(item => item.id === product.id);

            if (exi_in_cart) {
                exi_in_cart.quantity += product.quantity || 1;
            } else {
                cart.push({ ...product, quantity: product.quantity || 1 });
            }
        
            localStorage.setItem("cart", JSON.stringify(cart));
        }
        
          data.products.forEach(product => {
          const productDiv = document.createElement('div');
          productDiv.className = `product-box`;
      
          productDiv.innerHTML = `<img src="${product.img}" alt="${product.name}">
                                  <hr>
                                  <h3>${product.name}</h3>
                                  <p>${product.description}</p>
                                  <p><strong>${product.price}</strong> DH</p>
                                  <button class="add-to-cart-btn">Add to Cart</button>`;
      
          const button = productDiv.querySelector('.add-to-cart-btn');
          button.addEventListener('click', () => {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            const exi_in_cart = cart.find(item => item.id === product.id);
            if (exi_in_cart) {
              exi_in_cart.quantity += 1;
            } else {
              cart.push({ ...product, quantity: 1 });
            }
            localStorage.setItem("cart", JSON.stringify(cart));
            toastTheMssg(`${product.name} added to cart!`);
          });
      
          container.appendChild(productDiv);
        });
        })
          .catch(error => {
              console.error("Error fetching the products :", error);
              const container = document.getElementById('products');
              container.innerHTML = '';
              
              const fallbackProducts = [
                { product_id: "1", name: "Tomato", price: "6.00", description: "Vitamins A, C, K | Antioxidant | Heart-healthy | Hydrating", img: "../assets/images/vegetables/tomato.png" },
                { product_id: "4", name: "Bell Pepper", price: "11.00", description: "Vitamins A, C, B6 | Antioxidant | Eye-health | Low-calorie", img: "../assets/images/vegetables/bell_pepper.png" },
                { product_id: "6", name: "Apple", price: "5.00", description: "Vitamins C, B6, K | Heart-healthy | Fiber-rich | Antioxidant", img: "../assets/images/fruits/apple.png" },
                { product_id: "7", name: "Pear", price: "10.00", description: "Vitamins C, K, B6 | Fiber-rich | Heart-healthy | Antioxidant", img: "../assets/images/fruits/pear.png" },
                { product_id: "8", name: "Carrot", price: "3.00", description: "Vitamins A, K, B6 | Eye-health | Antioxidant | Fiber-rich", img: "../assets/images/vegetables/carrot.png" },
                { product_id: "10", name: "Cauliflower", price: "9.00", description: "Vitamins C, K, B6 | Fiber-rich | Antioxidant | Anti-inflammatory", img: "../assets/images/vegetables/cauliflower.png" },
                { product_id: "11", name: "Banana", price: "11.00", description: "Vitamins B6, C, A | Energy-boosting | Heart-healthy | Digestive support", img: "../assets/images/fruits/banana.png" },
                { product_id: "12", name: "Orange", price: "4.00", description: "Vitamins C, A, B1 | Immune support | Antioxidant | Heart-healthy", img: "../assets/images/fruits/orange.png" },
                { product_id: "13", name: "Potato", price: "3.00", description: "Vitamins C, B6, B3 | Energy-rich | Fiber source | Heart-healthy", img: "../assets/images/vegetables/potato.png" },
                { product_id: "14", name: "Onion", price: "3.00", description: "Vitamins C, B6, B1 | Antioxidant | Anti-inflammatory | Heart-healthy", img: "../assets/images/vegetables/onion.png" },
                { product_id: "15", name: "Mango", price: "15.00", description: "Vitamins A, C, E | Immune support | Antioxidant | Digestive health", img: "../assets/images/fruits/mango.png" },
                { product_id: "16", name: "Watermelon", price: "9.00", description: "Vitamins A, C, B6 | Hydrating | Antioxidant | Heart-healthy", img: "../assets/images/fruits/watermelon.png" },
              ];
            
              fallbackProducts.forEach(product => {
                const productDiv = document.createElement('div');
                productDiv.className = `product-box`;
            
                productDiv.innerHTML = `<img src="${product.img}" alt="${product.name}">
                                        <hr>
                                        <h3>${product.name}</h3>
                                        <p>${product.description}</p>
                                        <p><strong>${product.price}</strong> DH</p>
                                        <button class="add-to-cart-btn">Add to Cart</button>`;
            
                const button = productDiv.querySelector('.add-to-cart-btn');
                button.addEventListener('click', () => {
                  let cart = JSON.parse(localStorage.getItem("cart")) || [];
                  const exi_in_cart = cart.find(item => item.id === product.product_id);
                  if (exi_in_cart) {
                    exi_in_cart.quantity += 1;
                  } else {
                    cart.push({ ...product, id: product.product_id, quantity: 1 });
                  }
                  localStorage.setItem("cart", JSON.stringify(cart));
                  toastTheMssg(`${product.name} added to cart!`);
                });
                container.appendChild(productDiv);
              });
            });
          }

        function toastTheMssg(message) {
          const toastContainer = document.getElementById("toast-container");
          const toast = document.createElement("div");
          toast.className = "toast";
          toast.textContent = message;
          toastContainer.appendChild(toast);

          setTimeout(() => {toast.remove();}, 2500);
        }
        window.addEventListener("DOMContentLoaded", () => {
          fetchProducts();
        });
    </script>
</body>
</html>